name: NBA daily retry on scheduled failure

on:
  workflow_run:
    workflows: ["NBA daily box scores"]
    types:
      - completed

jobs:
  retry:
    if: >
      github.event.workflow_run.conclusion == 'failure' &&
      github.event.workflow_run.event == 'schedule' &&
      github.event.workflow_run.run_attempt == 1
    runs-on: ubuntu-latest

    steps:
      - name: Wait 2 hours before retry
        run: |
          echo "‚è≥ Waiting 2 hours before retry..."
          sleep 7200

      - name: Re-run failed workflow
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "üîÅ Retrying scheduled NBA daily box scores workflow"
          gh workflow run "NBA daily box scores"
